<style>
	.hover-control {
		pointer-events:none;
		text-align: center; padding: 0em 0.3em;
		border-radius:.5em;
		display:none;
		background:white;
		border:solid;
		border-width:1px;
	}
	.focused-tag-badge {
		border-width:4px !important;
		border-color:red !important;
	}
	.tag-badge {
		background:#e3eefd;
		color:black;
		border:solid;
		border-width:2px;
		margin:3px;
		font-size:1em;
	}
	.study-badge {
		background:#b1d6ef;
		color:black;
		border:solid;
		border-width:2px;
		margin:3px;
		font-size:1em;
	}
	#tag-filters .tag-badge {
		width:98%;
	}
	#tag-filters .study-badge {
		width:98%;
	}
	.require-tag-btn {
		color:green;
		float:right;
	}
	.exclude-tag-btn {
		color:red;
		float:left;
	}
	.remove-tag-btn {
		color:red;
		float:right;
	}
	.section-label {
		background:lightgray;
		border-top:solid;
		border-right:solid;
		border-left:solid;
		border-width:1px;
	}
	.section-body {
		background:white;
		border-bottom:solid;
		border-right:solid;
		border-left:solid;
		border-width:1px;
	}
</style>
{{#if hasActiveTags}}
	<div id='active-tags-section-div' role='region' class='section' tabindex=0 aria-label="You are in the active tag filters region. Use up and down arrows to move between active tag filters. Use the enter button to remove a filtered tag.">
		<div class='row section-label'>Active tag filters:</div>
			<div class='row section-body'>
				{{#if hasRequiredTags}}
					<div class='row'><span>Required Tags:</span>
						{{#each requiredTags}}
							<div class="badge {{colorClass this.tag}}">
								<span class="required-tag" id="tag-{{this.tag}}" aria-label="Tag {{this.tag}} is associated with {{this.score}} search results. Press enter to no longer require search results to have this tag."> {{aliasIfStudy this.tag}} ({{this.score}})
									<span data-tag="{{this.tag}}" data-action="removeRequiredTag" class="selected-required-tag remove-tag-btn hover-control">X</span>
								</span>
							</div>
						{{/each}}
					</div> 
				{{/if}}
				{{#if hasExcludedTags}}
					<div class='row'><span>Excluded Tags:</span>
						{{#each excludedTags}}
							<div class="badge {{colorClass this.tag}}">
								<span class="excluded-tag" id="tag-{{this.tag}}" aria-label="Tag {{this.tag}} is associated with {{this.score}} search results. Press enter to no longer exclude search results having this tag."> {{aliasIfStudy this.tag}} ({{this.score}})
									<span data-tag="{{this.tag}}" data-action="removeExcludedTag" class="selected-excluded-tag remove-tag-btn hover-control">X</span>
								</span>
							</div>
						{{/each}}
					</div>
				{{/if}}
			</div>
		</div>
	</div>
<br>
{{/if}}
{{#if hasInactiveStudyTags}}
<div id='study-tags-section-div' role='region' class='section' tabindex=0 aria-label="You are in the study tag filters region. Use up and down arrows to move between study tag filters. Use the right arrow to include only search results marked with the currently focused study tag. Use the left arrow to exclude all search results marked with the currently focused study tag.">
	<div class='row section-label'>Refine results using study based filters:</div>
	<div class='row section-body'>
		{{#each studyTags}}
			<div class="badge {{colorClass this.tag}}">
				<span id="tag-{{this.tag}}" aria-label="Study {{this.tag}} is associated with {{this.score}} search results. Press right arrow to include only search results having this tag. Press left arrow to exclude all search results having this tag."> {{aliasIfStudy this.tag}} ({{this.score}})
					<span data-tag="{{this.tag}}" data-action="requireTag" class="require-tag-btn hover-control">+</span> 
					<span data-tag="{{this.tag}}" data-action="excludeTag" class="exclude-tag-btn hover-control">-</span>
				</span>
			</div>
		{{/each}}
	</div>
</div>
<br>
{{/if}}
{{#if this.tagsShown}}
<div id='tags-section-div' role='region' class='section' tabindex=0 aria-label="You are in the tag filters region. Use up and down arrows to move between tag filters. Use the right arrow to include only search results marked with the currently focused tag. Use the left arrow to exclude all search results marked with the currently focused tag.">
	<div class='row section-label'>
	Refine results using tag based filters<br>
	Showing {{this.tagsShown}} out of {{this.tagsTotal}} tags that have variables which match your search term
	</div>
	<div class='row section-body unused-tags'>
		{{#each tags}}
			<div class="badge {{colorClass this.tag}}">
				<span id="tag-{{this.tag}}" aria-label="Tag {{this.tag}} is associated with {{this.score}} search results. Press right arrow to include only search results having this tag. Press left arrow to exclude all search results having this tag."> {{this.tag}} ({{this.score}})
					<span data-tag="{{this.tag}}" data-action="requireTag" class="require-tag-btn hover-control">+</span> 
					<span data-tag="{{this.tag}}" data-action="excludeTag" class="exclude-tag-btn hover-control">-</span>
				</span>
			</div>
		{{/each}}
		<br>
		{{#if tagsLimited}}
			<span id="show-all-tags-btn"> <span class="glyphicon glyphicon-chevron-down"></span> View more tags</span>
		{{else}}
			<span id="show-fewer-tags-btn"> <span class="glyphicon glyphicon-chevron-up"></span> View fewer tags</span>
		{{/if}}
	</div>
</div>
{{/if}}